"""Exploitation Tools Specifications.

Sqlmap, Metasploit, Brute force tools.
"""
from typing import List
from app.tools.specs import ToolSpec, ToolCategory, CommandTemplate


def get_specs() -> List[ToolSpec]:
    """Get exploitation tool specifications."""
    return [
        # ─────────────────────────────────────────────────────────
        # SQLMAP - Automated SQL Injection
        # ─────────────────────────────────────────────────────────
        ToolSpec(
            name="sqlmap",
            category=ToolCategory.EXPLOIT,
            description="Automatic SQL injection and database takeover tool",
            executable_names=["sqlmap"],
            install_hint="pip install sqlmap",
            aliases=["sql_injection", "sql_inject", "sqli"],
            rag_description="An open source penetration testing tool that automates the process of detecting and exploiting SQL injection flaws and taking over of database servers.",
            when_to_use=[
                "testing web parameters for SQL injection",
                "dumping database tables/contents",
                "attempting to gain shell access through SQL injection"
            ],
            commands={
                "test": CommandTemplate(
                    args=["-u", "{url}", "--batch", "--random-agent"],
                    timeout=600,
                    description="Basic SQL injection test"
                ),
                "dump": CommandTemplate(
                    args=["-u", "{url}", "--batch", "--dump", "--random-agent"],
                    timeout=1800,
                    description="Exploit and dump database content"
                ),
            }
        ),
        
        # ─────────────────────────────────────────────────────────
        # METASPLOIT - Exploitation Framework
        # ─────────────────────────────────────────────────────────
        ToolSpec(
            name="metasploit",
            category=ToolCategory.EXPLOIT,
            description="Exploitation framework",
            executable_names=["msfconsole"],
            install_hint="apt install metasploit-framework",
            aliases=["msf", "exploit_execution"],
            rag_description="The world's most used penetration testing framework. It provides information about security vulnerabilities and aids in penetration testing and IDS signature development.",
            when_to_use=[
                "executing known exploits against a target",
                "post-exploitation actions",
                "payload generation and management"
            ],
            commands={
                "check": CommandTemplate(
                    args=["-x", "use {module}; set RHOSTS {target}; check; exit"],
                    timeout=300,
                    description="Check if a target is vulnerable to a module"
                ),
                "exploit": CommandTemplate(
                    args=["-x", "use {module}; set RHOSTS {target}; {options}; run; exit"],
                    timeout=1200,
                    description="Execute an exploit module"
                ),
            }
        ),

        # ─────────────────────────────────────────────────────────
        # HYDRA - Network Login Brute-force
        # ─────────────────────────────────────────────────────────
        ToolSpec(
            name="hydra",
            category=ToolCategory.BRUTE,
            description="Network login cracker",
            executable_names=["hydra"],
            install_hint="apt install hydra",
            aliases=["brute_force", "login_cracker"],
            rag_description="A very fast network logon cracker which supports numerous protocols. It is used to perform brute-force or dictionary attacks against login pages or services (SSH, FTP, HTTP, etc.).",
            when_to_use=[
                "brute-forcing SSH, FTP, or Telnet passwords",
                "performing dictionary attacks on HTTP login forms",
                "testing for weak credentials on various services"
            ],
            commands={
                "ssh": CommandTemplate(
                    args=["-L", "{user_list}", "-P", "{pass_list}", "{target}", "ssh"],
                    timeout=1800,
                    description="Brute-force SSH login"
                ),
                "http_get": CommandTemplate(
                    args=["-l", "{user}", "-P", "{pass_list}", "{target}", "http-get", "{path}"],
                    timeout=1200,
                    description="Brute-force HTTP GET login"
                ),
            }
        ),
    ]
