"""Vulnerability Scanning Tools Specifications.

Nuclei, various vulnerability scanners.
"""
from typing import List
from app.tools.specs import ToolSpec, ToolCategory, CommandTemplate


def get_specs() -> List[ToolSpec]:
    """Get vulnerability tool specifications."""
    return [
        # ─────────────────────────────────────────────────────────
        # NUCLEI - Multi-purpose scanner
        # ─────────────────────────────────────────────────────────
        ToolSpec(
            name="nuclei",
            category=ToolCategory.VULN,
            description="Template-based vulnerability scanner",
            executable_names=["nuclei"],
            install_hint="go install github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest",
            aliases=["vuln_scan", "nuclei_scan", "scanner"],
            rag_description="A powerful and fast template-based vulnerability scanner. It allows sending requests across targets based on templates, leading to zero false positives and fast scanning on a large number of assets.",
            when_to_use=[
                "automated vulnerability scanning with community templates",
                "finding known CVEs on web applications",
                "detecting misconfigurations, exposures, and critical vulnerabilities"
            ],
            commands={
                "scan": CommandTemplate(
                    args=["-u", "{url}", "-silent", "-no-interactsh"],
                    timeout=600,
                    description="Standard vulnerability scan"
                ),
                "cves": CommandTemplate(
                    args=["-u", "{url}", "-t", "cves/", "-silent", "-no-interactsh"],
                    timeout=1200,
                    description="Scan for specific CVEs"
                ),
                "critical": CommandTemplate(
                    args=["-u", "{url}", "-severity", "critical,high", "-silent", "-no-interactsh"],
                    timeout=600,
                    description="Critical and High severity scan only"
                ),
                "tech": CommandTemplate(
                    args=["-u", "{url}", "-t", "technologies/", "-silent", "-no-interactsh"],
                    timeout=300,
                    description="Detect technologies via nuclei templates"
                ),
            }
        ),
    ]
